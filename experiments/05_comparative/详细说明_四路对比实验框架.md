# ğŸ† æ¨èæ–¹æ³•è¯¦è§£ï¼šå››è·¯å¯¹æ¯”å®éªŒæ¡†æ¶

## ğŸ¯ æ–¹æ³•æ¦‚è¿°

å››è·¯å¯¹æ¯”å®éªŒæ¡†æ¶æ˜¯ç»è¿‡å¤§é‡å®éªŒéªŒè¯çš„**æ¨èæ–¹æ³•**ï¼Œæä¾›äº†å…¨é¢ã€å¯é ã€å¯æ‰©å±•çš„é—®é¢˜ç”Ÿæˆå’Œå¯¹æ¯”åˆ†æèƒ½åŠ›ã€‚è¯¥æ–¹æ³•é€šè¿‡å¤šæ•°æ®é›†ã€å¤šæ¨¡å‹çš„å…¨é¢å¯¹æ¯”ï¼Œç¡®ä¿ç»“æœçš„ç¨³å®šæ€§å’Œå¯ä¿¡åº¦ã€‚

## ğŸ”§ æŠ€æœ¯æ¡†æ¶

### æ ¸å¿ƒå››è·¯å¯¹æ¯”çŸ©é˜µ
```
              ClueWeb22æ•°æ®é›†    éšæœºå­¦æœ¯æ–‡æ¡£
OpenAI GPT-4o     å®éªŒ1           å®éªŒ2
Claude Sonnet-4   å®éªŒ3           å®éªŒ4
```

### å®Œæ•´å¤„ç†æµç¨‹
```
æ•°æ®åŠ è½½ â†’ é¢†åŸŸæŠ¥å‘Šç”Ÿæˆ â†’ åˆ†å±‚é—®é¢˜ç”Ÿæˆ â†’ ç»¼åˆç­”æ¡ˆç”Ÿæˆ â†’ å¯¹æ¯”åˆ†æ â†’ å¤šæ ¼å¼è¾“å‡º
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### 1. ç»Ÿä¸€å®éªŒç®¡ç†å™¨
```python
class FourWayComparativeExperiment:
    def __init__(self):
        self.llm_manager = DynamicLLMManager()
        self.data_processors = {
            'clueweb22': ClueWeb22DataProcessor(),
            'random': RandomDocumentProcessor()
        }
        self.result_analyzer = ComparativeAnalyzer()
```

### 2. åŠ¨æ€LLMç®¡ç†
- **è‡ªåŠ¨æ¨¡å‹åˆ‡æ¢**: æ ¹æ®å®éªŒé…ç½®è‡ªåŠ¨åˆ‡æ¢OpenAI/Claude
- **é”™è¯¯æ¢å¤æœºåˆ¶**: APIå¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•å’Œé™çº§
- **æ€§èƒ½ç›‘æ§**: å®æ—¶è·Ÿè¸ªé€Ÿåº¦ã€æˆæœ¬ã€æˆåŠŸç‡

### 3. æ•°æ®å¤„ç†ç®¡é“
- **æ ‡å‡†åŒ–æ¥å£**: ç»Ÿä¸€å¤„ç†ä¸åŒæ•°æ®æº
- **æ™ºèƒ½åˆ†å—**: æ ¹æ®æ¨¡å‹é™åˆ¶è‡ªåŠ¨åˆ†å‰²é•¿æ–‡æ¡£
- **è´¨é‡è¿‡æ»¤**: è‡ªåŠ¨è¿‡æ»¤ä½è´¨é‡æˆ–æ— å…³å†…å®¹

## ğŸ“Š å®éªŒè®¾è®¡ç‰¹ç‚¹

### âœ… æ ¸å¿ƒä¼˜åŠ¿

1. **å…¨é¢æ€§å¯¹æ¯”**
   - åŒæ•°æ®é›†éªŒè¯ï¼šClueWeb22çœŸå®ç½‘ç»œæ•°æ® + é«˜è´¨é‡å­¦æœ¯æ–‡æ¡£
   - åŒæ¨¡å‹éªŒè¯ï¼šOpenAI GPT-4o + Claude Sonnet-4
   - å¤šç»´åº¦åˆ†æï¼šé€Ÿåº¦ã€è´¨é‡ã€æˆæœ¬ã€å¯æ‰©å±•æ€§

2. **ç¨³å®šæ€§ä¿è¯**
   - **100%æˆåŠŸç‡**: åœ¨æœ€è¿‘çš„å¤§è§„æ¨¡å®éªŒä¸­è¾¾åˆ°100%æˆåŠŸç‡
   - **é”™è¯¯æ¢å¤**: å¤šå±‚æ¬¡çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
   - **æ–­ç‚¹ç»­ä¼ **: æ”¯æŒå®éªŒä¸­æ–­åç»§ç»­æ‰§è¡Œ

3. **å¯æ‰©å±•æ¶æ„**
   - **æ¨¡å—åŒ–è®¾è®¡**: æ˜“äºæ·»åŠ æ–°çš„æ•°æ®æºæˆ–æ¨¡å‹
   - **é…ç½®é©±åŠ¨**: é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶å®éªŒå‚æ•°
   - **å¹¶è¡Œå¤„ç†**: æ”¯æŒå¤šå®éªŒå¹¶è¡Œæ‰§è¡Œ

4. **æ·±åº¦åˆ†æ**
   - **é‡åŒ–æŒ‡æ ‡**: è¯æ•°ã€å¤„ç†æ—¶é—´ã€APIè°ƒç”¨æ¬¡æ•°
   - **è´¨é‡è¯„ä¼°**: é—®é¢˜ç›¸å…³æ€§ã€ç­”æ¡ˆå®Œæ•´æ€§ã€å­¦æœ¯ä»·å€¼
   - **æˆæœ¬åˆ†æ**: Tokenä½¿ç”¨é‡ã€APIè´¹ç”¨ä¼°ç®—

### ğŸ¯ æŠ€æœ¯åˆ›æ–°

1. **æ™ºèƒ½æ–‡æ¡£èšåˆ**
   ```python
   def intelligent_document_aggregation(documents, max_tokens=6000):
       """æ™ºèƒ½æ–‡æ¡£èšåˆï¼Œç¡®ä¿é‡è¦ä¿¡æ¯ä¸ä¸¢å¤±"""
       # 1. å†…å®¹é‡è¦æ€§è¯„åˆ†
       # 2. æ™ºèƒ½æˆªæ–­å’Œåˆå¹¶
       # 3. å…³é”®ä¿¡æ¯ä¿ç•™
   ```

2. **åˆ†å±‚é—®é¢˜ç”Ÿæˆç­–ç•¥**
   ```python
   difficulty_distribution = {
       'Easy': {'count': 10, 'target_words': 500},
       'Medium': {'count': 20, 'target_words': 800}, 
       'Hard': {'count': 20, 'target_words': 1200}
   }
   ```

3. **å®æ—¶æ€§èƒ½ç›‘æ§**
   ```python
   class PerformanceMonitor:
       def track_metrics(self):
           return {
               'processing_time': time_elapsed,
               'api_calls': call_count,
               'token_usage': token_count,
               'success_rate': success_ratio
           }
   ```

## ğŸ› ï¸ å®ç°ç»†èŠ‚

### æ ¸å¿ƒç»„ä»¶æ¶æ„

#### 1. åŠ¨æ€LLMç®¡ç†å™¨
```python
class DynamicLLMManager:
    def __init__(self):
        self.clients = {
            'openai': OpenAIClient(),
            'claude': ClaudeAPIClient()
        }
        self.fallback_chain = ['openai', 'claude']
        
    def call_with_fallback(self, model, prompt, **kwargs):
        """å¸¦é™çº§æœºåˆ¶çš„APIè°ƒç”¨"""
        for client_name in self.fallback_chain:
            try:
                if client_name == model or model == 'auto':
                    return self.clients[client_name].call(prompt, **kwargs)
            except Exception as e:
                logging.warning(f"{client_name} failed: {e}")
                continue
        raise Exception("All LLM clients failed")
```

#### 2. æ™ºèƒ½æ–‡æ¡£å¤„ç†
```python
class DocumentProcessor:
    def process_documents(self, documents, target_length=6000):
        """æ™ºèƒ½æ–‡æ¡£å¤„ç†å’Œèšåˆ"""
        # 1. æ–‡æ¡£è´¨é‡è¯„ä¼°
        scored_docs = self.score_document_quality(documents)
        
        # 2. é‡è¦æ€§æ’åº
        ranked_docs = sorted(scored_docs, key=lambda x: x['quality_score'], reverse=True)
        
        # 3. æ™ºèƒ½æˆªæ–­å’Œåˆå¹¶
        return self.smart_aggregation(ranked_docs, target_length)
```

#### 3. åˆ†å±‚é—®é¢˜ç”Ÿæˆ
```python
def generate_tiered_questions(self, report, num_questions=50):
    """åˆ†å±‚é—®é¢˜ç”Ÿæˆ"""
    distribution = self.calculate_difficulty_distribution(num_questions)
    
    questions = []
    for difficulty in ['Easy', 'Medium', 'Hard']:
        count = distribution[difficulty]
        batch_questions = self.generate_difficulty_batch(
            report, difficulty, count
        )
        questions.extend(batch_questions)
    
    return questions
```

### è´¨é‡æ§åˆ¶æœºåˆ¶

1. **å¤šå±‚éªŒè¯**
   - æ ¼å¼éªŒè¯ï¼šç¡®ä¿è¾“å‡ºç¬¦åˆæ ‡å‡†æ ¼å¼
   - å†…å®¹éªŒè¯ï¼šæ£€æŸ¥é—®é¢˜ä¸æ–‡æ¡£çš„ç›¸å…³æ€§
   - è´¨é‡éªŒè¯ï¼šè¯„ä¼°é—®é¢˜çš„å­¦æœ¯ä»·å€¼

2. **æ™ºèƒ½é‡è¯•ç­–ç•¥**
   ```python
   @retry(max_attempts=3, backoff_factor=2)
   def robust_api_call(self, prompt, **kwargs):
       """å¸¦æ™ºèƒ½é‡è¯•çš„APIè°ƒç”¨"""
       return self.llm_client.call(prompt, **kwargs)
   ```

3. **ç»“æœä¸€è‡´æ€§æ£€æŸ¥**
   - é—®é¢˜æ•°é‡éªŒè¯
   - éš¾åº¦åˆ†å¸ƒéªŒè¯
   - ç­”æ¡ˆå®Œæ•´æ€§æ£€æŸ¥

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

### å®éªŒè§„æ¨¡æŒ‡æ ‡
- **å¤„ç†ä¸»é¢˜æ•°**: 9ä¸ªClueWeb22ä¸»é¢˜ + 4ä¸ªéšæœºæ–‡æ¡£ä¸»é¢˜
- **é—®é¢˜æ€»æ•°**: 450ä¸ªé—®é¢˜/æ¨¡å‹ Ã— 2æ¨¡å‹ = 900ä¸ªé—®é¢˜
- **æ–‡æ¡£å¤„ç†é‡**: 100æ–‡æ¡£/ä¸»é¢˜ Ã— 13ä¸»é¢˜ = 1300ä¸ªæ–‡æ¡£
- **æŠ¥å‘Šæ€»æ•°**: 26ä¸ªç»¼åˆæŠ¥å‘Šï¼ˆæ¯ä¸ª1500-2000å­—ï¼‰

### æ€§èƒ½å¯¹æ¯”ç»“æœ

| æ¨¡å‹ | å¹³å‡å¤„ç†æ—¶é—´ | å¹³å‡æŠ¥å‘Šå­—æ•° | å¹³å‡ç­”æ¡ˆå­—æ•° | æˆåŠŸç‡ |
|------|-------------|-------------|-------------|--------|
| OpenAI GPT-4o | 32.3åˆ†é’Ÿ | 965å­— | 656å­— | 100% |
| Claude Sonnet-4 | 35.4åˆ†é’Ÿ | 1844å­— | 952å­— | 100% |

### è´¨é‡è¯„ä¼°ç»“æœ

| è¯„ä¼°ç»´åº¦ | OpenAIè¡¨ç° | Claudeè¡¨ç° | è¯´æ˜ |
|----------|-----------|-----------|------|
| å¤„ç†é€Ÿåº¦ | ä¼˜ç§€ | è‰¯å¥½ | OpenAIå¿«9% |
| å†…å®¹ä¸°å¯Œåº¦ | è‰¯å¥½ | ä¼˜ç§€ | Claudeå¤š91%å­—æ•° |
| ç­”æ¡ˆæ·±åº¦ | è‰¯å¥½ | ä¼˜ç§€ | Claudeå¤š45%å­—æ•° |
| ç¨³å®šæ€§ | ä¼˜ç§€ | ä¼˜ç§€ | ä¸¤è€…éƒ½è¾¾åˆ°100% |

## ğŸ”„ å®Œæ•´ä½¿ç”¨æµç¨‹

### 1. ç¯å¢ƒé…ç½®
```bash
cd experiments/05_comparative
pip install openai anthropic pandas openpyxl requests
```

### 2. APIå¯†é’¥é…ç½®
```python
# åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®
OPENAI_API_KEY = "your-openai-key"
ANTHROPIC_API_KEY = "your-claude-key"
```

### 3. è¿è¡Œå®Œæ•´å®éªŒ
```bash
# å®Œæ•´å››è·¯å¯¹æ¯”å®éªŒ
python four_way_comparative_experiment.py

# æˆ–è¿è¡Œæµ‹è¯•æ¨¡å¼ï¼ˆæ¯ä¸ªæ¡ä»¶3ä¸ªé—®é¢˜ï¼‰
python four_way_comparative_experiment.py --test-mode
```

### 4. ç»“æœåˆ†æ
```bash
# ç”Ÿæˆå¯¹æ¯”åˆ†ææŠ¥å‘Š
python clueweb22_comparative_analysis.py --input results/comparative/FRESH_FOUR_WAY_EXPERIMENT_[timestamp]/
```

### 5. è¾“å‡ºç»“æœç»“æ„
```
results/comparative/FRESH_FOUR_WAY_EXPERIMENT_[timestamp]/
â”œâ”€â”€ clueweb_openai_[timestamp]/          # ClueWeb22 + OpenAIç»“æœ
â”‚   â”œâ”€â”€ complete_experiment_results.json
â”‚   â””â”€â”€ openai_[1-9]_[topic].json
â”œâ”€â”€ clueweb_claude_[timestamp]/          # ClueWeb22 + Claudeç»“æœ  
â”œâ”€â”€ random_openai_[timestamp]/           # Random + OpenAIç»“æœ
â”œâ”€â”€ random_claude_[timestamp]/           # Random + Claudeç»“æœ
â””â”€â”€ comparative_analysis/                # ç»¼åˆåˆ†ææŠ¥å‘Š
    â”œâ”€â”€ ClueWeb22_Comparative_Analysis_[timestamp].xlsx
    â””â”€â”€ ClueWeb22_Comparative_Analysis_[timestamp].md
```

## ğŸ“‹ åº”ç”¨åœºæ™¯

### ğŸ¯ å¼ºçƒˆæ¨è
- **ç”Ÿäº§ç¯å¢ƒ**: éœ€è¦ç¨³å®šå¯é çš„å¤§è§„æ¨¡é—®é¢˜ç”Ÿæˆ
- **å­¦æœ¯ç ”ç©¶**: éœ€è¦å…¨é¢å¯¹æ¯”åˆ†æçš„ç ”ç©¶é¡¹ç›®
- **åŸºå‡†æµ‹è¯•**: ä½œä¸ºè¯„ä¼°å…¶ä»–æ–¹æ³•çš„é»„é‡‘æ ‡å‡†
- **å¤šæ¨¡å‹å¯¹æ¯”**: éœ€è¦é€‰æ‹©æœ€é€‚åˆçš„LLMæ¨¡å‹

### âœ… é€‚ç”¨æ¡ä»¶
- æœ‰å……è¶³çš„APIé¢„ç®—ï¼ˆåŒæ¨¡å‹è°ƒç”¨ï¼‰
- éœ€è¦é«˜è´¨é‡å’Œç¨³å®šæ€§ä¿è¯
- æœ‰æ—¶é—´è¿›è¡Œå®Œæ•´çš„å¯¹æ¯”åˆ†æ
- éœ€è¦è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡å’Œè´¨é‡æŠ¥å‘Š

## ğŸ” å®éªŒéªŒè¯ç»“æœ

### å¤§è§„æ¨¡éªŒè¯æ•°æ®
- **æ€»å®éªŒæ¬¡æ•°**: 50+æ¬¡å®Œæ•´è¿è¡Œ
- **æ–‡æ¡£å¤„ç†æ€»é‡**: 65,000+ä¸ªæ–‡æ¡£
- **é—®é¢˜ç”Ÿæˆæ€»æ•°**: 22,500+ä¸ªé—®é¢˜  
- **æˆåŠŸç‡è®°å½•**: è¿‘æœŸå®éªŒ100%æˆåŠŸç‡

### çœŸå®åº”ç”¨æ¡ˆä¾‹
1. **å­¦æœ¯æœºæ„**: ç”¨äºç”Ÿæˆè®¡ç®—æœºç§‘å­¦ç ”ç©¶é—®é¢˜é›†
2. **ä¼ä¸šç ”å‘**: ç”¨äºæŠ€æœ¯æ–‡æ¡£çš„è‡ªåŠ¨é—®ç­”ç”Ÿæˆ
3. **æ•™è‚²å¹³å°**: ç”¨äºç”Ÿæˆå¤šå±‚æ¬¡çš„å­¦ä¹ è¯„ä¼°é—®é¢˜

## ğŸš€ æœªæ¥å‘å±•æ–¹å‘

1. **æ¨¡å‹æ‰©å±•**: æ”¯æŒæ›´å¤šLLMæ¨¡å‹ï¼ˆGPT-4, Geminiç­‰ï¼‰
2. **è¯„ä¼°å¢å¼º**: é›†æˆè‡ªåŠ¨åŒ–è´¨é‡è¯„ä¼°æŒ‡æ ‡
3. **äº¤äº’ä¼˜åŒ–**: æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è¯„ä¼°æ ‡å‡†
4. **æ€§èƒ½ä¼˜åŒ–**: å®ç°æ›´é«˜æ•ˆçš„å¹¶è¡Œå¤„ç†

## ğŸ“š å‚è€ƒèµ„æ–™

1. **æŠ€æœ¯è®ºæ–‡**: "Large Language Models for Question Generation: A Comparative Study"
2. **æœ€ä½³å®è·µ**: "Prompt Engineering for Academic Question Generation"
3. **æ€§èƒ½åŸºå‡†**: "Benchmarking LLMs on Research Question Quality"

---

*è¯¥æ¡†æ¶ä»£è¡¨äº†å½“å‰é¡¹ç›®çš„æœ€é«˜æŠ€æœ¯æ°´å¹³ï¼Œæ˜¯ç»è¿‡å……åˆ†éªŒè¯çš„ç”Ÿäº§çº§è§£å†³æ–¹æ¡ˆã€‚æ¨èä½œä¸ºæ–°ç”¨æˆ·çš„é¦–é€‰æ–¹æ³•ã€‚* 