# ğŸ¯ Agentæ·±åº¦æ¨ç†æµ‹è¯•æ¡†æ¶ (Agent Depth Reasoning Test Framework)

## ğŸ“‹ æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**å…¨æ–°è®¾è®¡çš„Agentæ·±åº¦æ¨ç†æµ‹è¯•æ¡†æ¶**ï¼Œä¸“é—¨ä¸ºæ™ºèƒ½Agentè®¾è®¡æ·±åº¦æ¨ç†æµ‹è¯•é¢˜ã€‚æ¡†æ¶çš„**æ ¸å¿ƒç›®æ ‡**æ˜¯è®©æ™®é€šLLMæ— æ³•ç›´æ¥è·å–ç­”æ¡ˆï¼Œè€Œéœ€è¦Agentå…·å¤‡é€æ­¥æ¨ç†èƒ½åŠ›ï¼Œæ’é™¤å¹²æ‰°é¡¹ï¼Œæœ€ç»ˆæ‰¾åˆ°æ­£ç¡®ç­”æ¡ˆã€‚

### ğŸ¯ è®¾è®¡ç†å¿µ

- **ä¸ºæ™ºèƒ½Agentå‡ºé¢˜**ï¼šä¸“é—¨æµ‹è¯•Agentçš„æ·±åº¦æ¨ç†èƒ½åŠ›
- **é˜²æ­¢ç›´æ¥ç­”æ¡ˆ**ï¼šæ™®é€šLLMæ— æ³•ç›´æ¥è·å–ç­”æ¡ˆ
- **é€æ­¥æ¨ç†è®­ç»ƒ**ï¼šè®­ç»ƒAgenté€šè¿‡å¤šæ­¥éª¤æ¨ç†è§£å†³é—®é¢˜
- **åµŒå¥—å¼ç»¼åˆé—®é¢˜**ï¼šæœ€ç»ˆç”Ÿæˆå¤æ‚çš„å±‚å±‚åµŒå¥—é—®é¢˜

## ğŸ”§ 6æ­¥è®¾è®¡æµç¨‹

### Step 1: Short Answeræå– + æœ€å°ç²¾ç¡®é—®é¢˜æ„å»º
- ä»æ–‡æ¡£ä¸­æå–**3ä¸ªæ˜ç¡®ä¸”å”¯ä¸€çš„Short Answer**ï¼ˆä¸“æœ‰åè¯æˆ–æ•°å­—ï¼‰
- ä¸ºæ¯ä¸ªShort Answeræ„å»º**æœ€å°ç²¾ç¡®é—®é¢˜**ï¼ˆä½¿ç”¨Webæœç´¢+LLMåˆ†æï¼‰
- ç¡®ä¿é—®é¢˜åŒ…å«**è‡³å°‘ä¸¤ä¸ªå…³é”®è¯**ä»¥ä¿è¯ç­”æ¡ˆå”¯ä¸€æ€§
- ç§»é™¤éå¿…è¦å…³é”®è¯ï¼Œä¿ç•™**æœ€å°ç²¾ç¡®é—®é¢˜**

### Step 2: Root Queryæœ€å°å…³é”®è¯æå–
- æå–Root Queryçš„**æœ€å°å…³é”®è¯**ï¼ˆèƒ½ç¡®å®šç­”æ¡ˆçš„æœ€å°æ•°é‡ï¼‰
- å…³é”®è¯ç±»å‹ï¼šä¸“æœ‰åè¯ã€æ•°å­—ã€æŠ€æœ¯æœ¯è¯­ã€æ—¥æœŸã€åœ°ç‚¹
- éªŒè¯æ¯ä¸ªå…³é”®è¯çš„**å¿…è¦æ€§**ï¼ˆç§»é™¤æµ‹è¯•ï¼‰

### Step 3: Seriesæ·±åº¦æ‰©å±•
- é’ˆå¯¹æ¯ä¸ªå…³é”®è¯åš**Seriesæ·±åº¦æ‰©å±•**
- ä½¿ç”¨Webæœç´¢+LLMåˆ†æç”Ÿæˆæ–°é—®é¢˜
- ç¡®ä¿æ–°é—®é¢˜ä¸Rooté—®é¢˜**å®Œå…¨æ— å…³è”**

### Step 4: Parallelæ¨ªå‘æ‰©å±•
- é’ˆå¯¹æ‰€æœ‰å…³é”®è¯åš**Parallelæ¨ªå‘æ‰©å±•**
- ç”Ÿæˆnä¸ªä¸åŒçš„æœ€ç²¾ç¡®é—®é¢˜ï¼ˆn=å…³é”®è¯æ•°é‡ï¼‰
- æ¯ä¸ªé—®é¢˜éƒ½ä¸Rooté—®é¢˜**å®Œå…¨æ— å…³è”**

### Step 5: å¤šå±‚æ ‘ç»“æ„æ„å»º
- é‡å¤Step 3-4è¿‡ç¨‹ï¼Œæ„å»º**æœ€å¤š3å±‚é—®é¢˜æ ‘**
- åŠ¨æ€ç»“æ„ï¼š1ä¸ªå…³é”®è¯â†’2å±‚Seriesï¼Œå¤šå…³é”®è¯â†’3å±‚Series+Parallel
- æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯**åŸºäºæœ€å°å…³é”®è¯çš„ç²¾ç¡®é—®é¢˜**

### Step 6: åµŒå¥—å¼ç»¼åˆé—®é¢˜ç”Ÿæˆ
- ç³…åˆæ‰€æœ‰å±‚çº§çš„é—®é¢˜
- ç”Ÿæˆ**(query,query,query...)**åµŒå¥—å¼ç»¼åˆé—®é¢˜
- ç­”æ¡ˆä»ç„¶æ˜¯Rootçš„ç­”æ¡ˆï¼Œä½†éœ€è¦**Agenté€æ­¥æ¨ç†**

## ğŸ—ï¸ æ¡†æ¶æ¶æ„

### æ ¸å¿ƒç»„ä»¶

```
AgentDepthReasoningFramework (ä¸»æ¡†æ¶)
â”œâ”€â”€ ShortAnswer (çŸ­ç­”æ¡ˆæ•°æ®ç»“æ„)
â”œâ”€â”€ MinimalKeyword (æœ€å°ç²¾ç¡®å…³é”®è¯)
â”œâ”€â”€ PreciseQuery (ç²¾ç¡®é—®é¢˜ç»“æ„)
â”œâ”€â”€ QuestionTreeNode (é—®é¢˜æ ‘èŠ‚ç‚¹)
â””â”€â”€ AgentReasoningTree (Agentæ¨ç†æ ‘)
```

### å…³é”®ç®—æ³•

1. **æœ€å°å…³é”®è¯éªŒè¯ç®—æ³•**ï¼šé€šè¿‡maskingæµ‹è¯•ç¡®å®šå…³é”®è¯å¿…è¦æ€§
2. **æ— å…³è”æ€§éªŒè¯ç®—æ³•**ï¼šç¡®ä¿é—®é¢˜é—´å®Œå…¨ç‹¬ç«‹
3. **åŠ¨æ€æ ‘ç»“æ„ç®—æ³•**ï¼šæ ¹æ®å…³é”®è¯æ•°é‡å†³å®šæ ‘ç»“æ„
4. **åµŒå¥—ç»¼åˆé—®é¢˜ç®—æ³•**ï¼šå°†å¤šå±‚é—®é¢˜ç³…åˆæˆç»¼åˆé—®é¢˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 2. è¿è¡Œæµ‹è¯•
```bash
python test_agent_reasoning.py
```

### 3. è¿è¡Œå®Œæ•´å®éªŒ
```bash
python agent_reasoning_main.py
```

### 4. é…ç½®è¯´æ˜
- è¾“å…¥OpenAI APIå¯†é’¥
- é€‰æ‹©ClueWeb22ä¸»é¢˜
- è®¾ç½®æœ€å¤§æ–‡æ¡£å¤„ç†æ•°é‡

## ğŸ“Š è¾“å‡ºç»“æœ

### å¯¼å‡ºæ–‡ä»¶
- **JSONç»“æœ**ï¼šå®Œæ•´çš„æ¨ç†æ ‘å’Œè½¨è¿¹æ•°æ®
- **ExcelæŠ¥å‘Š**ï¼šå¤šSheetè¯¦ç»†åˆ†æï¼ˆæ‘˜è¦ã€æ¨ç†æ ‘ã€ç»¼åˆé—®é¢˜ã€è½¨è¿¹è®°å½•ã€ç»Ÿè®¡ä¿¡æ¯ï¼‰
- **Markdownæ‘˜è¦**ï¼šå¯è¯»æ€§å¼ºçš„æ‘˜è¦æŠ¥å‘Š

### å…³é”®æŒ‡æ ‡
- **æ¨ç†æ ‘æ•°é‡**ï¼šç”Ÿæˆçš„Agentæ¨ç†æµ‹è¯•æ ‘æ•°é‡
- **ç»¼åˆé—®é¢˜æ•°é‡**ï¼šæœ€ç»ˆç”Ÿæˆçš„åµŒå¥—å¼ç»¼åˆé—®é¢˜æ•°é‡
- **è½¨è¿¹å®Œæ•´æ€§**ï¼šæ¯ä¸ªæ­¥éª¤çš„è¯¦ç»†è®°å½•
- **éªŒè¯é€šè¿‡ç‡**ï¼šé—®é¢˜è´¨é‡éªŒè¯é€šè¿‡æ¯”ä¾‹

## ğŸ” æŠ€æœ¯ç‰¹ç‚¹

### ä¸WorkFlowè®¾è®¡å…¼å®¹
- âœ… **Extract root keywords**ï¼šæå–é«˜åº¦ç‰¹å®šçš„å…³é”®è¯
- âœ… **Generate simple query**ï¼šç”Ÿæˆå”¯ä¸€ç­”æ¡ˆçš„æŸ¥è¯¢
- âœ… **Answer verifier**ï¼šå¤šå±‚éªŒè¯æœºåˆ¶
- âœ… **Series & Parallel Extension**ï¼šåŒé‡æ‰©å±•ç­–ç•¥
- âœ… **Minimum Keyword Check**ï¼šæœ€å°å…³é”®è¯éªŒè¯
- âœ… **Shortcut Check**ï¼šæ— å…³è”æ€§éªŒè¯

### æ ¸å¿ƒåˆ›æ–°
- **Agentå¯¼å‘è®¾è®¡**ï¼šä¸“é—¨ä¸ºAgentæ¨ç†èƒ½åŠ›æµ‹è¯•è®¾è®¡
- **æœ€å°ç²¾ç¡®å…³é”®è¯**ï¼šç¡®ä¿é—®é¢˜çš„ç²¾ç¡®æ€§å’Œå”¯ä¸€æ€§
- **æ— å…³è”æ€§è¦æ±‚**ï¼šé¿å…é—®é¢˜é—´çš„ç›¸äº’å½±å“
- **åŠ¨æ€æ ‘ç»“æ„**ï¼šæ ¹æ®å…³é”®è¯æ•°é‡è‡ªé€‚åº”è°ƒæ•´ç»“æ„
- **åµŒå¥—ç»¼åˆé—®é¢˜**ï¼šæŒ‘æˆ˜Agentçš„ç»¼åˆæ¨ç†èƒ½åŠ›

## ğŸ“ˆ å®éªŒéªŒè¯

### æµ‹è¯•ç”¨ä¾‹
```python
# Short Answeræå–æµ‹è¯•
âœ… æå–åˆ° 3 ä¸ªShort Answer:
  1. Tesla Inc. (proper_noun, ç½®ä¿¡åº¦: 0.90)
  2. 2.1 seconds (number, ç½®ä¿¡åº¦: 0.85)  
  3. 35 GWh (number, ç½®ä¿¡åº¦: 0.80)

# æœ€å°å…³é”®è¯æå–æµ‹è¯•
âœ… ä»é—®é¢˜ä¸­æå–åˆ° 3 ä¸ªæœ€å°å…³é”®è¯:
  1. 'electric vehicle' (technical_term, å”¯ä¸€æ€§: 0.80, å¿…è¦æ€§: 0.90)
  2. '2003' (date, å”¯ä¸€æ€§: 0.95, å¿…è¦æ€§: 0.85)
  3. 'Model S' (proper_noun, å”¯ä¸€æ€§: 0.90, å¿…è¦æ€§: 0.80)

# æ¨ç†æ ‘æ„å»ºæµ‹è¯•
âœ… æ¨ç†æ ‘ç»“æ„:
  æ ‘ID: test_tree_001
  èŠ‚ç‚¹æ•°é‡: 2
  æœ€å¤§å±‚çº§: 3
  æ ¹é—®é¢˜: Which electric vehicle company founded in 2003 produces the Model S?
  ç»¼åˆé—®é¢˜: To identify the target company, first determine what type of propulsion system is used in advanced automotive technology, then consider which company founded in 2003 produces the Model S. What is the final answer?
```

### æ¡†æ¶ç‰¹æ€§éªŒè¯
- âœ… **6æ­¥è®¾è®¡æµç¨‹**
- âœ… **æœ€å°ç²¾ç¡®å…³é”®è¯**
- âœ… **æ— å…³è”æ€§éªŒè¯**
- âœ… **åŠ¨æ€æ ‘ç»“æ„**
- âœ… **åµŒå¥—ç»¼åˆé—®é¢˜**
- âœ… **è½¨è¿¹è®°å½•**
- âœ… **Agentæ·±åº¦æµ‹è¯•**
- âœ… **WorkFlowå…¼å®¹**
- âœ… **Webæœç´¢é›†æˆ**
- âœ… **Excel/JSONå¯¼å‡º**

## ğŸ”§ APIæ–‡æ¡£

### AgentDepthReasoningFramework ä¸»ç±»

```python
class AgentDepthReasoningFramework:
    def __init__(self, api_client=None, search_client=None):
        """åˆå§‹åŒ–Agentæ·±åº¦æ¨ç†æ¡†æ¶"""
    
    def process_document_for_agent_reasoning(self, document_content: str, document_id: str) -> Dict[str, Any]:
        """å¤„ç†æ–‡æ¡£ï¼Œç”ŸæˆAgentæ¨ç†æµ‹è¯•æ•°æ®"""
    
    def set_api_client(self, api_client):
        """è®¾ç½®APIå®¢æˆ·ç«¯"""
    
    def set_search_client(self, search_client):
        """è®¾ç½®æœç´¢å®¢æˆ·ç«¯"""
```

### å…³é”®æ•°æ®ç»“æ„

```python
@dataclass
class ShortAnswer:
    """çŸ­ç­”æ¡ˆæ•°æ®ç»“æ„"""
    answer_text: str
    answer_type: str  # noun, number, name, date, location
    confidence: float
    extraction_source: str
    document_position: int

@dataclass
class MinimalKeyword:
    """æœ€å°ç²¾ç¡®å…³é”®è¯"""
    keyword: str
    keyword_type: str  # proper_noun, number, technical_term, date
    uniqueness_score: float
    necessity_score: float
    extraction_context: str
    position_in_query: int

@dataclass
class AgentReasoningTree:
    """Agentæ¨ç†æµ‹è¯•æ ‘"""
    tree_id: str
    root_node: QuestionTreeNode
    all_nodes: Dict[str, QuestionTreeNode]
    max_layers: int = 3
    final_composite_query: str = ""
    trajectory_records: List[Dict]
```

## ğŸ¯ åº”ç”¨åœºæ™¯

### 1. Agentèƒ½åŠ›è¯„ä¼°
- æµ‹è¯•Agentçš„**å¤šæ­¥æ¨ç†èƒ½åŠ›**
- è¯„ä¼°Agentå¯¹**å¤æ‚é—®é¢˜çš„åˆ†è§£èƒ½åŠ›**
- éªŒè¯Agentçš„**é€»è¾‘æ¨ç†é“¾å®Œæ•´æ€§**

### 2. LLMå¯¹æ¯”ç ”ç©¶
- å¯¹æ¯”**æ™®é€šLLM vs Agent**çš„æ¨ç†èƒ½åŠ›å·®å¼‚
- ç ”ç©¶**é—®é¢˜å¤æ‚åº¦**å¯¹ä¸åŒæ¨¡å‹çš„å½±å“
- åˆ†æ**æ¨ç†è·¯å¾„çš„æ•ˆç‡å’Œå‡†ç¡®æ€§**

### 3. è®­ç»ƒæ•°æ®ç”Ÿæˆ
- ä¸ºAgentè®­ç»ƒç”Ÿæˆ**é«˜è´¨é‡æ¨ç†æ•°æ®**
- æ„å»º**åˆ†å±‚æ¬¡çš„æ¨ç†è®­ç»ƒé›†**
- æä¾›**å®Œæ•´çš„æ¨ç†è½¨è¿¹æ ‡æ³¨**

## ğŸ”® æœªæ¥å‘å±•

### çŸ­æœŸä¼˜åŒ–
- [ ] å¢åŠ æ›´å¤šå…³é”®è¯ç±»å‹æ”¯æŒ
- [ ] ä¼˜åŒ–æ— å…³è”æ€§éªŒè¯ç®—æ³•
- [ ] æ‰©å±•ç»¼åˆé—®é¢˜ç”Ÿæˆæ¨¡å¼

### ä¸­æœŸæ‰©å±•
- [ ] æ”¯æŒå¤šæ¨¡æ€Agentæ¨ç†æµ‹è¯•
- [ ] é›†æˆæ›´å¤šçŸ¥è¯†æºå’Œæœç´¢å¼•æ“
- [ ] å¼€å‘å®æ—¶Agentèƒ½åŠ›è¯„ä¼°ç³»ç»Ÿ

### é•¿æœŸæ„¿æ™¯
- [ ] æ„å»ºæ ‡å‡†åŒ–Agentæ¨ç†èƒ½åŠ›è¯„ä¼°ä½“ç³»
- [ ] å»ºç«‹Agentæ¨ç†èƒ½åŠ›åŸºå‡†æµ‹è¯•é›†
- [ ] æ¨åŠ¨Agentæ¨ç†èƒ½åŠ›æ ‡å‡†åŒ–ç ”ç©¶

## ğŸ“ å¼•ç”¨

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº†è¿™ä¸ªæ¡†æ¶ï¼Œè¯·å¼•ç”¨ï¼š

```bibtex
@software{agent_depth_reasoning_framework_2025,
  title={Agent Depth Reasoning Test Framework},
  author={ClueWeb22 Question Generation Team},
  year={2025},
  url={https://github.com/your-repo/agent-depth-reasoning}
}
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªæ¡†æ¶ï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**ğŸ¯ Agentæ·±åº¦æ¨ç†æµ‹è¯•æ¡†æ¶ - ä¸ºæ™ºèƒ½Agentæ„å»ºæ·±åº¦æ¨ç†æµ‹è¯•é¢˜ï¼Œé˜²æ­¢æ™®é€šLLMç›´æ¥ç­”é¢˜ï¼** 